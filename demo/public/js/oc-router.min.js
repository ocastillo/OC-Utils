/*!
OC-Utils 0.1.0
http://www.orlandocastillo.com
(c) 2014 Orlando Castillo
This may be freely distributed under the MIT license.
*/
var oc=oc||{};oc.Router=function(){"use strict";function a(a){return a.replace(/^\/|\#\/|\#/,"")}function b(b){b=a(b);for(var c in j){var d=j[c],e=d.route,f=e.exec(b);if(f&&f.length)return f.shift(),d.callback.apply(this,f),f}if(g&&"string"==typeof g)return window.location=g;if(g&&"function"==typeof g)return g();throw new Error("That route does not exist")}function c(a){if("a"===a.target.tagName.toLowerCase()){a.preventDefault();var c=a.target.href,d=c.replace(f,""),e=d.split("#"),g=b(e[0]);history.pushState(g,a.target.textContent,c)}}function d(a){a.state&&a.state.input&&b(a.state.input),a.preventDefault()}var e,f,g,h,i="undefined"==typeof window.history.pushState?!1:!0,j=[];return{start:function(k){if(h)throw new Error("The router is already started.");if("object"!=typeof k)throw new Error("Expecting object as a parameter");if(!k.routes)throw new Error("Please specify one or more routes");h=!0,e=k.routes,g=k.not_found||!1,f=k.root||"",f=window.location.origin+f;for(var l in e){var m=a(l),n=/\:([a-zA-Z.]+)/gi,m=m.replace(n,"([^/]+)"),o=new RegExp("^"+m+"$");j.push({route:o,callback:e[l]})}var p=window.location.href.replace(f,"");i&&(document.addEventListener("click",c),window.addEventListener("popstate",d));var q=b(p);i&&history.replaceState(q,document.title,document.location.href)},stop:function(){document.removeEventListener("click",c),window.removeEventListener("popstate",d),h=null}}}();